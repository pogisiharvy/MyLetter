<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>A Love Letter</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="https://i.loli.net/2021/06/03/lFg2V4WUcmkB98G.png">
    <meta name="language" content="en-US">
    <meta name="title" content="Student Sun">
    <meta name="describe"
        content="It’s not easy to collect all this. Your star is my motivation to keep going. PRs are also welcome!">
    <link type="text/css" rel="stylesheet" href="./Love_files/default.css">
    <script type="text/javascript" src="./Love_files/jquery.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-parser.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-jit.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-builderbase.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-async.min.js"></script>
    <script type="text/javascript" src="./Love_files/jscex-async-powerpack.min.js"></script>
    <script type="text/javascript" src="./Love_files/functions.js" charset="utf-8"></script>
    <script type="text/javascript" src="./Love_files/love.js" charset="utf-8"></script>
</head>

<body>
    <div id="main">
        <div id="error">Dear, your browser does not support the content about to be displayed. Please switch to Google
            Chrome (<a href="http://www.google.cn/chrome/intl/zh-CN/landing_chrome.html?hl=zh-CN&brand=CHMI">Chrome</a>)
            or Firefox (<a href="http://firefox.com.cn/download/">Firefox</a>)~</div>
        <div id="wrap">
            <div id="text">
                <div id="code">
                    <span class="say">If love is a choice, then I choose you every day, no matter how many lifetimes we
                        live. It's not just the beautiful moments that make this love real, it's the hard ones too. It's
                        the times we hold each other, when words aren't enough, when silence speaks louder than anything
                        we could say, and when your hand in mine says, I'm here more than any promise could.
                    </span><br><br>
                    <span class="say">In a world of endless possibilities, I would choose you a thousand times. With
                        you, love isn't about perfection, it's about the quiet certainty that no matter what, you're the
                        one I want by my side, even when the days are long and dreams feel far away. I feel this choice
                        in every sunrise, every heartbeat, every breath, and even if life to me isn't just a feeling,
                        it's the choice I make to be with you today, tomorrow, and for all comes next.</span><br>
                    <br>
                    <br>
                    <span class="say">- Yours, Habi.</span>
                </div>

            </div>
            <div id="clock-box">
                <a href="https://sunguoqi.com" target="_blank">The stars</a> and <a href="https://sunguoqi.com"
                    target="_blank">the moon</a> have been together for
                <div id="clock"></div>
            </div>
            <canvas id="canvas" width="1100" height="680"></canvas>
        </div>
    </div>
    
    <footer id="copyright">
        Copyright © 2025 Harvy. All rights reserved.
    </footer>

    <audio id="media" src="message.MP3" preload="auto"></audio>

    <script>
        // Existing script remains the same
        (function () {
            var canvas = $('#canvas');

            if (!canvas[0].getContext) {
                $("#error").show();
                return false;
            }

            var width = canvas.width();
            var height = canvas.height();

            canvas.attr("width", width);
            canvas.attr("height", height);

            var opts = {
                seed: {
                    x: width / 2 - 20,
                    color: "rgb(190, 26, 37)",
                    scale: 2
                },
                branch: [
                    [535, 680, 570, 250, 500, 200, 30, 100, [
                        [540, 500, 455, 417, 340, 400, 13, 100, [
                            [450, 435, 434, 430, 394, 395, 2, 40]
                        ]],
                        [550, 445, 600, 356, 680, 345, 12, 100, [
                            [578, 400, 648, 409, 661, 426, 3, 80]
                        ]],
                        [539, 281, 537, 248, 534, 217, 3, 40],
                        [546, 397, 413, 247, 328, 244, 9, 80, [
                            [427, 286, 383, 253, 371, 205, 2, 40],
                            [498, 345, 435, 315, 395, 330, 4, 60]
                        ]],
                        [546, 357, 608, 252, 678, 221, 6, 100, [
                            [590, 293, 646, 277, 648, 271, 2, 80]
                        ]]
                    ]]
                ],
                bloom: {
                    num: 700,
                    width: 1080,
                    height: 650,
                },
                footer: {
                    width: 1200,
                    height: 5,
                    speed: 10,
                }
            }

            var tree = new Tree(canvas[0], width, height, opts);
            var seed = tree.seed;
            var foot = tree.footer;
            var hold = 1;

            canvas.click(function (e) {
                var offset = canvas.offset(), x, y;
                x = e.pageX - offset.left;
                y = e.pageY - offset.top;
                if (seed.hover(x, y)) {
                    hold = 0;
                    canvas.unbind("click");
                    canvas.unbind("mousemove");
                    canvas.removeClass('hand');
                }
            }).mousemove(function (e) {
                var offset = canvas.offset(), x, y;
                x = e.pageX - offset.left;
                y = e.pageY - offset.top;
                canvas.toggleClass('hand', seed.hover(x, y));
            });

            var seedAnimate = eval(Jscex.compile("async", function () {
                seed.draw();
                while (hold) {
                    $await(Jscex.Async.sleep(10));
                }
                while (seed.canScale()) {
                    seed.scale(0.95);
                    $await(Jscex.Async.sleep(10));
                }
                while (seed.canMove()) {
                    seed.move(0, 2);
                    foot.draw();
                    $await(Jscex.Async.sleep(10));
                }
            }));

            var growAnimate = eval(Jscex.compile("async", function () {
                do {
                    tree.grow();
                    $await(Jscex.Async.sleep(10));
                } while (tree.canGrow());
            }));

            var flowAnimate = eval(Jscex.compile("async", function () {
                do {
                    tree.flower(2);
                    $await(Jscex.Async.sleep(10));
                } while (tree.canFlower());
            }));

            var moveAnimate = eval(Jscex.compile("async", function () {
                tree.snapshot("p1", 240, 0, 610, 680);
                while (tree.move("p1", 500, 0)) {
                    foot.draw();
                    $await(Jscex.Async.sleep(10));
                }
                foot.draw();
                tree.snapshot("p2", 500, 0, 610, 680);

                canvas.parent().css("background", "url(" + tree.toDataURL('image/png') + ")");
                canvas.css("background", "#ffc0cb");
                $await(Jscex.Async.sleep(300));
                canvas.css("background", "none");
            }));

            var jumpAnimate = eval(Jscex.compile("async", function () {
                var ctx = tree.ctx;
                while (true) {
                    tree.ctx.clearRect(0, 0, width, height);
                    tree.jump();
                    foot.draw();
                    $await(Jscex.Async.sleep(25));
                }
            }));

            var textAnimate = eval(Jscex.compile("async", function () {
                $("#code").show().typewriter();
                $("#media")[0].play();
            }));

            var runAsync = eval(Jscex.compile("async", function () {
                $await(seedAnimate());
                $await(growAnimate());
                $await(flowAnimate());
                $await(moveAnimate());

                textAnimate().start();

                $await(jumpAnimate());
            }));

            runAsync().start();
        })();
    </script>
    
    <script>
    // New script for responsive scaling
    function scaleContent() {
        const wrap = document.getElementById('wrap');
        const main = document.getElementById('main');
        const originalWidth = 1100;
        const originalHeight = 680;

        const windowWidth = window.innerWidth;

        // Do not scale up, only scale down
        let scale = Math.min(windowWidth / originalWidth, 1.0);

        // Apply the scale transform
        wrap.style.transformOrigin = 'top center';
        wrap.style.transform = `scale(${scale})`;

        // Adjust the height of the container to fit the scaled content
        main.style.height = `${originalHeight * scale}px`;
    }

    // Scale on initial load and on window resize
    window.addEventListener('load', scaleContent);
    window.addEventListener('resize', scaleContent);
    </script>

</body>

</html>